#!/usr/bin/env node

/* jshint node: true */

'use strict';

/**
 * Read records from an Avro container file.
 *
 */

var streams = require('../lib'),
    util = require('util');

var fpath = process.argv[2];
if (!fpath) {
  console.error(util.format('usage: %s PATH [COUNT]', process.argv[1]));
  process.exit(1);
}
var count = process.argv[3] ? Number.parseInt(process.argv[3]) : Infinity;

streams.createFileDecoder(fpath)
  .on('data', function (data) {
    count--;
    if (count < 0) {
      process.exit(0);
    }
    console.log(JSON.stringify(data));
  });
